<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEVANTE Framework Translation Pipeline</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            overflow: hidden;
        }

        /* Slide Container */
        .slide-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        .slide {
            display: none;
            padding: 60px;
            height: 100vh;
            overflow-y: auto;
            background: white;
            margin: 20px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .slide.active {
            display: block;
        }

        /* Typography */
        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
        }

        h2 {
            color: #764ba2;
            font-size: 2em;
            margin: 30px 0 15px 0;
        }

        h3 {
            color: #555;
            font-size: 1.3em;
            margin: 20px 0 10px 0;
        }

        p, li {
            line-height: 1.6;
            margin-bottom: 10px;
        }

        /* Navigation */
        .navigation {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .nav-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 20px;
            margin: 0 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .slide-counter {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: rgba(255,255,255,0.9);
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: bold;
            z-index: 1000;
        }

        /* Mermaid Styles */
        .mermaid {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            overflow: auto;
            box-shadow: 0 8px 24px rgba(0,0,0,0.06);
        }

        /* Interactive Elements */
        .interactive-demo {
            background: #f8f9fa;
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .demo-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }

        .demo-button:hover {
            background: #764ba2;
            transform: scale(1.05);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .slide {
                padding: 30px;
                margin: 10px;
            }

            h1 {
                font-size: 2em;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            themeVariables: {
                primaryColor: '#eef2ff',
                primaryTextColor: '#1f2937',
                primaryBorderColor: '#667eea',
                lineColor: '#667eea',
                fontFamily: 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif'
            }
        });
    </script>
</head>
<body>
    <div class="slide-container">
        <!-- Slide 1: Title -->
<div class="slide active">
  <h1>LEVANTE Framework Translation Pipeline</h1>
  <div style="text-align: center; margin: 50px 0;">
                <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 30px; border-radius: 15px; display: inline-block; margin: 20px; box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);">
      <h3>A Comprehensive Data Flow Overview</h3>
                    <ul style="text-align: left; list-style: none; margin-top: 20px;">
                        <li>• Translation Pipeline Architecture</li>
                        <li>• Audio Generation Process</li>
                        <li>• Dashboard Integration</li>
                        <li>• Production Deployment</li>
      </ul>
    </div>
  </div>
  <p style="text-align: center; font-style: italic; color: #666; font-size: 1.2em;">
    For Developers Working on LEVANTE Translation Systems
  </p>
</div>

        <!-- Slide 2: System Architecture (Mermaid) -->
<div class="slide">
  <h1>System Architecture Overview</h1>
  <div class="mermaid">
flowchart TD
subgraph Repos[GitHub Repositories]
                        LT[levante_translations<br/>- Audio generation<br/>- CSV/XLIFF/ICU<br/>- Web/desktop dashboards]
                        LD[levante-dashboard<br/>- Vue app<br/>- CSV to JSON build<br/>- i18n tools]
                        LS[levante-surveys<br/>- SurveyJS JSON<br/>- JSON to CSV for Crowdin<br/>- Cypress validation]
                    end

                    CROW[Crowdin Project<br/>levantetranslations<br/>- File mapping & QA<br/>- Translators]

subgraph GCP[Google Cloud Storage]
                        ADEV[levante-assets-dev<br/>- translations/ csv, xliff, icu<br/>- audio/<br/>- surveys/]
                        APROD[levante-assets-prod<br/>- mirror of dev after prod deploy]
                        DDEV[levante-dashboard-dev<br/>- item-bank-translations.csv<br/>- surveys/]
                        DPROD[levante-dashboard-prod<br/>- prod CSV/surveys]
end

LT --> CROW
LD --> CROW
LS --> CROW

CROW --> ADEV
CROW --> DDEV

LT --> ADEV
LS --> ADEV
LD --> DDEV

                    ADEV -.-> APROD
                    DDEV -.-> DPROD
</div>
</div>

        <!-- Slide 3: Translation Pipeline (Mermaid) -->
<div class="slide">
            <h1>End-to-End Translation Pipeline</h1>
  <div class="mermaid">
flowchart LR
                    SRC[Source Content<br/>- Tasks CSV/XLIFF<br/>- Survey JSON<br/>- Dashboard CSV] 
                    --> EXTRACT[Extract/Normalize<br/>- CSV/XLIFF/ICU<br/>- Standardize codes es-CO, de-CH]
                    
                    EXTRACT --> CROW[Crowdin<br/>- Column mapping<br/>- Translators<br/>- QA checks]
                    
                    CROW --> DL[Download/Import<br/>- Update CSV/JSON<br/>- Rebuild ICU/JSON]
                    
                    DL --> VALIDATE[Validation<br/>- CSV checks<br/>- Cypress surveys<br/>- Core tasks checks]
                    
                    VALIDATE --> DEPLOY_DEV[Deploy to Dev<br/>- levante-assets-dev<br/>- levante-dashboard-dev]
                    
                    DEPLOY_DEV -.-> DEPLOY_PROD[Deploy to Prod<br/>- levante-assets-prod<br/>- levante-dashboard-prod]
</div>
</div>

        <!-- Slide 4: Audio Generation Pipeline (Mermaid) -->
<div class="slide">
            <h1>Audio Generation Pipeline</h1>
  <div class="mermaid">
flowchart TD
                    SRC[item_bank_translations.csv<br/>l10n_pending/main] 
                    --> NORM[Normalize<br/>- identifier to item_id<br/>- header fixes<br/>- hyphenated locales]
                    
                    NORM --> CACHE[Compare with translation_master.csv<br/>- find new/changed items]
                    
CACHE --> DIFF[needed_item_bank_translations.csv]
                    
                    DIFF -->|service=PlayHT| PHT[PlayHT v2<br/>- voice mapping<br/>- SSML<br/>- retries]
                    DIFF -->|service=ElevenLabs| EL[ElevenLabs v1<br/>- multilingual_v2<br/>- curated voices]
                    
                    PHT --> OUT[audio_files/lang/item.mp3<br/>+ ID3 tags]
                    EL --> OUT
                    
                    OUT --> GCS[GCS levante-audio-dev<br/>rsync checksum, csv/xliff/icu mirrors]
            </div>
        </div>

        <!-- Slide 5: Dashboard i18n Build Flow (Mermaid) -->
        <div class="slide">
            <h1>Dashboard i18n Build Flow</h1>
            <div class="mermaid">
                flowchart LR
                    CONS[src/translations/consolidated/.csv] 
                    --> CSV2JSON[i18n:csv-to-json<br/>merge, validate, split]
                    
                    CSV2JSON --> LOCALES[src/translations/locale/.json]
                    
                    LOCALES --> APP[Vue i18n runtime<br/>- dynamic loading<br/>- fallbacks]
                    
                    APP --> HOST[Deploy Firebase Hosting<br/>Dev/Prod flavors]
</div>
</div>

        <!-- Slide 6: Surveys Crowdin Roundtrip (Mermaid) -->
<div class="slide">
            <h1>Surveys Crowdin Roundtrip</h1>
  <div class="mermaid">
flowchart TD
                    SJSON[Survey JSON<br/>child/parent/teacher] 
                    --> EX[Extract to CSV<br/>scripts/extract-translations.js<br/>- discover languages<br/>- hyphen codes]
                    
                    EX --> CROW[Crowdin<br/>- per-survey CSVs<br/>- file mapping in UI]
                    
                    CROW --> DL[Download CSV<br/>per-survey _crowdin_translations.csv]
                    
                    DL --> IMPORT[Import to JSON<br/>scripts/import-individual-surveys.js<br/>- elementName+source match<br/>- CSV to JSON map]
                    
                    IMPORT --> CYPRESS[Cypress e2e<br/>- render & structure checks<br/>- artifact detection]
                    
                    CYPRESS --> DEPLOY[Deploy to GCS<br/>levante-dashboard-dev/surveys<br/>levante-assets-dev/surveys]
                    
                    DEPLOY -.-> PROD[Sync to Prod on release<br/>-prod buckets]
            </div>
        </div>

        <!-- Slide 7: Contact & Resources -->
        <div class="slide">
            <h1>Contact & Resources</h1>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 30px; margin: 30px 0;">
                <div style="background: white; border: 2px solid #e2e8f0; border-radius: 15px; padding: 20px; text-align: center;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">Repository Links</h4>
                    <ul style="text-align: left; list-style: none;">
                        <li><strong>levante_translations:</strong><br>github.com/levante-framework/levante_translations</li>
                        <li><strong>levante-dashboard:</strong><br>github.com/levante-framework/levante-dashboard</li>
                        <li><strong>levante-surveys:</strong><br>github.com/levante-framework/levante-surveys</li>
                    </ul>
                </div>
                
                <div style="background: white; border: 2px solid #e2e8f0; border-radius: 15px; padding: 20px; text-align: center;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">Live Deployments</h4>
                    <ul style="text-align: left; list-style: none;">
                        <li><strong>Web Dashboard:</strong><br>audio-dashboard-levante.vercel.app</li>
                        <li><strong>Production Dashboard:</strong><br>platform.levante-network.org</li>
                        <li><strong>Crowdin Project:</strong><br>levantetranslations</li>
                    </ul>
                </div>
                
                <div style="background: white; border: 2px solid #e2e8f0; border-radius: 15px; padding: 20px; text-align: center;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">Support Resources</h4>
                    <ul style="text-align: left; list-style: none;">
                        <li>README files in each repository</li>
                        <li>GitHub Issues for bug reports</li>
                        <li>Team Slack channels</li>
                        <li>Weekly sync meetings</li>
                    </ul>
</div>
</div>

            <div style="text-align: center; margin: 50px 0; padding: 30px; background: #f8f9fa; border-radius: 15px;">
                <h2 style="color: #667eea;">Thank You!</h2>
                <p style="font-size: 1.2em; color: #666; margin: 20px 0;">
                    Questions and discussion welcome
                </p>
                <div class="interactive-demo">
                    <button class="demo-button" onclick="goToSlide(0)">Back to Start</button>
                    <button class="demo-button" onclick="openGitHub()">View on GitHub</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="slide-counter">
        <span id="currentSlide">1</span> / <span id="totalSlides">7</span>
    </div>
    
    <div class="navigation">
        <button class="nav-btn" onclick="previousSlide()">← Previous</button>
        <button class="nav-btn" onclick="nextSlide()">Next →</button>
    </div>

    <script>
        let currentSlideIndex = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        document.getElementById('totalSlides').textContent = totalSlides;

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            document.getElementById('currentSlide').textContent = index + 1;
            
            // Render Mermaid diagrams for the active slide
            const activeSlide = slides[index];
            if (activeSlide) {
                const mermaidElements = activeSlide.querySelectorAll('.mermaid');
                mermaidElements.forEach((element, i) => {
                    if (!element.getAttribute('data-processed')) {
                        const code = element.textContent.trim();
                        const id = `mermaid-${index}-${i}`;
                        
                        // Clear the element first
                        element.innerHTML = '';
                        element.setAttribute('data-processed', 'true');
                        
                        // Use setTimeout to ensure DOM is ready
                        setTimeout(() => {
                            try {
                                mermaid.render(id, code).then(({ svg }) => {
                                    element.innerHTML = svg;
                                }).catch((error) => {
                                    console.error('Mermaid rendering error:', error);
                                    element.innerHTML = `<div style="color: red; padding: 20px;">Error rendering diagram: ${error.message}</div>`;
                                });
                            } catch (error) {
                                console.error('Mermaid render call error:', error);
                                element.innerHTML = `<div style="color: red; padding: 20px;">Error: ${error.message}</div>`;
                            }
                        }, 100);
                    }
                });
            }
        }

        function nextSlide() {
            currentSlideIndex = (currentSlideIndex + 1) % totalSlides;
            showSlide(currentSlideIndex);
        }

        function previousSlide() {
            currentSlideIndex = (currentSlideIndex - 1 + totalSlides) % totalSlides;
            showSlide(currentSlideIndex);
        }

        function goToSlide(index) {
            currentSlideIndex = index;
            showSlide(currentSlideIndex);
        }

        function openGitHub() {
            window.open('https://github.com/levante-framework/levante_translations', '_blank');
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                previousSlide();
            } else if (e.key >= '1' && e.key <= '9') {
                const slideNum = parseInt(e.key) - 1;
                if (slideNum < totalSlides) {
                    goToSlide(slideNum);
                }
            }
        });

        // Initialize when DOM and Mermaid are ready
        function initializeSlides() {
            if (typeof mermaid !== 'undefined') {
                showSlide(0);
            } else {
                setTimeout(initializeSlides, 100);
            }
        }
        
        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeSlides);
        } else {
            initializeSlides();
        }
    </script>
</body>
</html>